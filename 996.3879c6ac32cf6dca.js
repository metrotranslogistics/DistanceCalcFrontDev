"use strict";(self.webpackChunkDistanceCalcFront=self.webpackChunkDistanceCalcFront||[]).push([[996],{1996:(ee,Z,s)=>{s.r(Z),s.d(Z,{VechilesHistoryModule:()=>k});var c=s(4719),p=s(6895),m=s(5146),e=s(5062);let T=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-1"],[1,"container"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"router-outlet"),e.qZA()())},dependencies:[m.lC],encapsulation:2}),i})();var h=s(7224),f=s(805),d=s(5439),v=s(9429),g=s(793);const U=["dt"];function A(i,a){1&i&&(e.TgZ(0,"tr")(1,"th",5)(2,"table")(3,"tr",6),e._uU(4,"distance (mile)"),e.qZA()()(),e.TgZ(5,"th",7)(6,"table")(7,"tr"),e._uU(8,"Dispatch"),e.qZA(),e.TgZ(9,"tr"),e._uU(10,"Category"),e.qZA(),e.TgZ(11,"tr"),e._uU(12,"Vehicle Id"),e.qZA(),e.TgZ(13,"tr"),e._uU(14,"Driver Id"),e.qZA(),e.TgZ(15,"tr"),e._uU(16,"Contact Number"),e.qZA(),e.TgZ(17,"tr"),e._uU(18,"Location"),e.qZA()()(),e.TgZ(19,"th",8)(20,"table")(21,"tr"),e._uU(22,"Vehicle Type"),e.qZA(),e.TgZ(23,"tr"),e._uU(24,"Dimensions"),e.qZA(),e.TgZ(25,"tr"),e._uU(26,"Payload"),e.qZA(),e.TgZ(27,"tr"),e._uU(28,"AvailableNote"),e.qZA()()(),e.TgZ(29,"th",9)(30,"table")(31,"tr"),e._uU(32,"Loc DateTime "),e._UZ(33,"p-sortIcon",10),e.qZA(),e.TgZ(34,"tr"),e._uU(35,"W9 Expire"),e.qZA(),e.TgZ(36,"tr"),e._uU(37,"Insurance Expire"),e.qZA(),e.TgZ(38,"tr"),e._uU(39,"Registration Expire"),e.qZA(),e.TgZ(40,"tr"),e._uU(41,"Licence Expire"),e.qZA(),e.TgZ(42,"tr"),e._uU(43,"Miles"),e.qZA(),e.TgZ(44,"tr"),e._uU(45,"Price"),e.qZA(),e.TgZ(46,"tr"),e._uU(47,"Average $"),e.qZA()()(),e.TgZ(48,"th",8)(49,"table")(50,"tr"),e._uU(51,"Status"),e.qZA(),e.TgZ(52,"tr"),e._uU(53,"Dockhigh"),e.qZA(),e.TgZ(54,"tr"),e._uU(55,"LiftGate"),e.qZA(),e.TgZ(56,"tr"),e._uU(57,"Team"),e.qZA(),e.TgZ(58,"tr"),e._uU(59,"StatusUpdateDate"),e.qZA(),e.TgZ(60,"tr"),e._uU(61,"StatusUpdateUser"),e.qZA()()(),e.TgZ(62,"th",7)(63,"table")(64,"tr"),e._uU(65,"Actions"),e.qZA()()()())}function x(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.lockUser," Reserved \xa0\xa0 Minutes left: ",t.lockMinuteLeft," ")}}function I(i,a){1&i&&e._UZ(0,"span")}function D(i,a){1&i&&e._UZ(0,"span",24)}function b(i,a){1&i&&e._UZ(0,"span",25)}function C(i,a){if(1&i&&(e.TgZ(0,"tr",26),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.locationDateTime)}}function q(i,a){if(1&i&&(e.TgZ(0,"tr",17),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.locationDateTime)}}const H=function(i,a){return{"border-style":i,"border-color":a}},y=function(){return[]};function L(i,a){if(1&i&&(e.TgZ(0,"tr",11)(1,"td")(2,"table")(3,"tr",12),e.YNc(4,x,2,2,"span",13),e.YNc(5,I,1,0,"span",13),e.qZA(),e.TgZ(6,"tr",6),e._uU(7),e.qZA(),e.TgZ(8,"tr"),e.YNc(9,D,1,0,"span",14),e.YNc(10,b,1,0,"span",15),e.qZA()()(),e.TgZ(11,"td")(12,"table")(13,"tr",16),e._uU(14),e.qZA(),e.TgZ(15,"tr",12),e._uU(16),e.qZA(),e.TgZ(17,"tr",17),e._uU(18),e.qZA(),e.TgZ(19,"tr",17),e._uU(20),e.qZA()()(),e.TgZ(21,"td")(22,"table")(23,"tr",17),e._uU(24),e.qZA(),e.TgZ(25,"tr",17),e._uU(26),e.qZA(),e.TgZ(27,"tr",17),e._uU(28),e.qZA(),e.TgZ(29,"tr",17),e._uU(30),e.qZA()()(),e.TgZ(31,"td")(32,"table"),e.YNc(33,C,2,1,"ng-template",18),e.YNc(34,q,2,1,"ng-template",null,19,e.W1O),e.TgZ(36,"tr",20),e._uU(37),e.qZA(),e.TgZ(38,"tr",20),e._uU(39),e.qZA(),e.TgZ(40,"tr",6),e._uU(41),e.ALo(42,"number"),e.qZA()()(),e.TgZ(43,"td")(44,"table")(45,"tr",21),e._uU(46),e.qZA(),e.TgZ(47,"tr",17),e._uU(48),e.qZA(),e.TgZ(49,"tr",17),e._uU(50),e.qZA(),e.TgZ(51,"tr",17),e._uU(52),e.qZA(),e.TgZ(53,"tr",17),e._uU(54),e.qZA(),e.TgZ(55,"tr",17),e._uU(56),e.qZA()()(),e.TgZ(57,"td",22)(58,"a",23),e._uU(59,"Edit"),e.qZA()()()),2&i){const t=a.$implicit,n=e.MAs(35),r=e.oxw();e.Q6J("pSelectableRow",t)("ngStyle",e.WLB(30,H,r.isOutdatedExpire(t.w9date)||r.isOutdatedExpire(t.insuranceDate)||r.isOutdatedExpire(t.vechRegDate)||r.isOutdatedExpire(t.licenseDate)?"double":"single",r.isOutdatedExpire(t.w9date)||r.isOutdatedExpire(t.insuranceDate)||r.isOutdatedExpire(t.vechRegDate)||r.isOutdatedExpire(t.licenseDate)?"red":"green")),e.xp6(4),e.Q6J("ngIf","locked"==t.statusId),e.xp6(1),e.Q6J("ngIf","free"==t.statusId),e.xp6(2),e.Oqu(t.distance),e.xp6(2),e.Q6J("ngForOf",e.DdM(33,y).constructor(r.toIntg(t.rating))),e.xp6(1),e.Q6J("ngForOf",e.DdM(34,y).constructor(r.toIntg(5-t.rating))),e.xp6(4),e.Oqu(t.dispatch),e.xp6(2),e.Oqu(t.category),e.xp6(2),e.Oqu(t.contactNumber),e.xp6(2),e.Oqu(t.location),e.xp6(4),e.Oqu(t.vechileType),e.xp6(2),e.Oqu(t.dimensions),e.xp6(2),e.Oqu(t.payload),e.xp6(2),e.Oqu(t.availableNote),e.xp6(3),e.Q6J("ngIf",r.isOutdated(t.locationDateTime))("ngIfElse",n),e.xp6(4),e.Oqu(t.miles),e.xp6(2),e.Oqu(t.price),e.xp6(2),e.hij(" ",e.xi3(42,27,t.price/t.miles,"1.2-2"),""),e.xp6(5),e.Oqu(t.status),e.xp6(2),e.hij("",t.dockHigh," Dock"),e.xp6(2),e.hij("",t.liftGate," Lift"),e.xp6(2),e.hij("",t.team," Team"),e.xp6(2),e.hij("",t.statusUpdateDate," StatusUpdateDate"),e.xp6(2),e.hij("",t.statusUpdateUser," StatusUpdateUser"),e.xp6(2),e.MGl("routerLink","edit/",t.id,"")}}const O=function(){return["vechileType","distance","vechileId","driverId","contactNumber","location","dimensions","payload","availableNote","locationDateTime","status","dockHigh","liftGate","team","statusUpdateDate","statusUpdateUser"]},N=[{path:"",component:T,children:[{path:"",component:(()=>{class i{constructor(t,n,r,l){this.vechileService=t,this.messageService=n,this.accountService=r,this.intervalConfigService=l,this.miles="",this.price="",this.pricePerMile="",this.vechileOriginId="",this.vechilesHistory=[],this.selectedRow=0,this.stateZip="",this.userName="",this.userRole="",this.ip="",this.intervalConfig=[],this.selectedCategory=[],this.categories=[],this.selectedVechType=[],this.vechTypes=[],this.selectedRatingType=[],this.ratingTypes=["0","1","2","3","4","5"],this.cols=[],this.sprinter=!1,this.small=!1,this.large=!1,this.form=new c.cw({rds:new c.NI("rds",c.kI.minLength(2)),dstzp:new c.NI("dstzp",c.kI.minLength(2)),vchlid:new c.NI("vchlid",c.kI.minLength(1)),sprinter:new c.NI("sprinter",c.kI.minLength(1)),small:new c.NI("small",c.kI.minLength(1)),large:new c.NI("large",c.kI.minLength(1))})}ngOnInit(){this.currentDatTime=new Date,this.intervalConfigService.getAll().pipe((0,h.P)()).subscribe(t=>this.intervalConfig=t),this.accountService.getById(this.accountService.userValue.id).pipe((0,h.P)()).subscribe(t=>{this.userRole=t.role,this.userName=t.firstName,this.ip=t.ip,this.vechileService.getHistory().pipe((0,h.P)()).subscribe(n=>{this.vechilesHistory=n;for(let o=0;o<this.vechilesHistory.length;o++)this.categories.findIndex(u=>u.label==this.vechilesHistory[o].category)<=-1&&this.categories.push({label:this.vechilesHistory[o].category,value:this.vechilesHistory[o].category}),this.vechTypes.findIndex(u=>u.label==this.vechilesHistory[o].vechileType)<=-1&&this.vechTypes.push({label:this.vechilesHistory[o].vechileType,value:this.vechilesHistory[o].vechileType})})}),this.form.get("rds").setValue(""),this.form.get("dstzp").setValue(""),this.form.get("vchlid").setValue("")}toIntg(t){return Number(t)}updateTimeDiffs(){this.timeDiffsByVechId=new Map,this.vechilesHistory.forEach(t=>{this.vechileService.getLockTimeDiff(t.vechileId).subscribe(n=>{this.timeDiffsByVechId.set(t.vechileId,n)})})}isOutdatedExpire(t){var n=d(new Date),r=d(t);return d.duration(n.diff(r)).asDays()>=parseInt(this.intervalConfig[0].expireDateInterval)}hideBillingDialog(){this.billingDialog=!1}getLockTimeDiff(t){return this.vechileService.getLockTimeDiff(t).subscribe(n=>this.ress=n),this.ress}openBillingDialog(t){this.vechileOriginId=t,this.vechileService.getById(t).pipe((0,h.P)()).subscribe(n=>{this.miles=n.miles,this.price=n.price}),this.billingDialog=!0}selectVechileHistory(t){this.messageService.add({severity:"info",summary:"VechileHistory Selected",detail:t.payload})}onRowSelect(t){this.messageService.add({severity:"info",summary:"VechileHistory Selected",detail:t.data.name})}toggleVisibility(t){}isOutdated(t){var n=d(new Date),r=d(t);return d.duration(n.diff(r)).asDays()>parseInt(this.intervalConfig[0].locDateInterval)}onVechileHistoryChange(t){this.table.filter(t.value,"vechileHistory","in")}onRepresentativeChange(t){this.table.filter(t.value,"representative","in")}onRowUnselect(t){this.messageService.add({severity:"info",summary:"VechileHistory Unselected",detail:t.data.name})}customSort(t){t.data.sort((n,r)=>{let l=n[t.field],o=r[t.field],u=null;return u=null==l&&null!=o?-1:null!=l&&null==o?1:null==l&&null==o?0:"string"==typeof l&&"string"==typeof o?l.localeCompare(o):l<o?-1:l>o?1:0,t.order*u})}deleteVechileHistory(t){if(!confirm("Are you sure you want to delete?"))return!1;this.vechilesHistory.find(l=>l.id===t),this.vechileService.delete(t).pipe((0,h.P)()).subscribe(()=>{this.vechilesHistory=this.vechilesHistory.filter(l=>l.id!==t)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.HT),e.Y36(f.ez),e.Y36(v.BR),e.Y36(v.cY))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],viewQuery:function(t,n){if(1&t&&e.Gf(U,5),2&t){let r;e.iGM(r=e.CRH())&&(n.table=r.first)}},features:[e._Bn([f.ez,p.uU])],decls:5,vars:5,consts:[[1,"card"],["selectionMode","single","dataKey","id",1,"table","table-striped","table-hover",3,"value","selection","filterDelay","globalFilterFields","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],[2,"width","20%"],[2,"color","red"],[2,"width","25%"],[2,"width","30%"],["pSortableColumn","payload",2,"width","25%"],["field","payload"],[3,"pSelectableRow","ngStyle"],[2,"color","red","font-weight","bold"],[4,"ngIf"],["class","fa fa-star checked",4,"ngFor","ngForOf"],["class","fa fa-star unchecked",4,"ngFor","ngForOf"],[2,"color","green","font-weight","bold"],[2,"color","green"],[3,"ngIf","ngIfElse"],["validDate",""],[2,"color","blue"],[2,"color","white"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-info","mr-1",3,"routerLink"],[1,"fa","fa-star","checked"],[1,"fa","fa-star","unchecked"],[2,"color","red","border-style","double","border-color","red"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"p-table",1,2),e.NdJ("selectionChange",function(l){return n.selectedVechileHistory=l}),e.YNc(3,A,66,0,"ng-template",3),e.YNc(4,L,60,35,"ng-template",4),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("value",n.vechilesHistory)("selection",n.selectedVechileHistory)("filterDelay",0)("globalFilterFields",e.DdM(4,O)))},dependencies:[p.sg,p.O5,p.PC,m.yS,g.iA,f.jx,g.lQ,g.Ei,g.fz,p.JJ],encapsulation:2}),i})()},{path:"info/:driverId",component:s(4681).y}]}];let E=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Bz.forChild(N),m.Bz]}),i})();var M=s(9483),R=s(9549),F=s(4144),w=s(3238),J=s(6308),B=s(5415),Y=s(666),j=s(2453),Q=s(585),z=s(8177),P=s(5722),G=s(4076),$=s(1493),X=s(5593),W=s(8235),_=s(1740),K=s(1383);let k=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.ez,c.UX,E,M.FA,R.lN,F.c,w.XK,J.JX,B.T,g.U$,Y.kW,j.EV,Q._8,z.JH,P.q4,G.vI,$.S,X.hJ,W.q,_.j,c.u5,K.V]}),i})()}}]);