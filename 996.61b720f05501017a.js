"use strict";(self.webpackChunkDistanceCalcFront=self.webpackChunkDistanceCalcFront||[]).push([[996],{1996:($,y,s)=>{s.r(y),s.d(y,{VechilesHistoryModule:()=>X});var c=s(4719),d=s(6895),m=s(5146),e=s(5062);let Z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-1"],[1,"container"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"router-outlet"),e.qZA()())},dependencies:[m.lC],encapsulation:2}),i})();var g=s(7224),v=s(805),h=s(5439),f=s(9429),p=s(793);const T=["dt"];function A(i,a){1&i&&(e.TgZ(0,"tr")(1,"th",5)(2,"table")(3,"tr"),e._uU(4,"StatusUpdateDate"),e.qZA(),e.TgZ(5,"tr"),e._uU(6,"Status"),e.qZA(),e.TgZ(7,"tr"),e._uU(8,"Vehicle Id"),e.qZA(),e.TgZ(9,"tr"),e._uU(10,"Driver Id"),e.qZA(),e.TgZ(11,"tr"),e._uU(12,"Contact Number"),e.qZA(),e.TgZ(13,"tr"),e._uU(14,"Location"),e.qZA()()(),e.TgZ(15,"th",6)(16,"table")(17,"tr"),e._uU(18,"Dispatch"),e.qZA(),e.TgZ(19,"tr"),e._uU(20,"Category"),e.qZA(),e.TgZ(21,"tr"),e._uU(22,"Vehicle Type"),e.qZA(),e.TgZ(23,"tr"),e._uU(24,"Dimensions"),e.qZA(),e.TgZ(25,"tr"),e._uU(26,"Payload"),e.qZA(),e.TgZ(27,"tr"),e._uU(28,"AvailableNote"),e.qZA()()(),e.TgZ(29,"th",7)(30,"table")(31,"tr"),e._uU(32,"Loc DateTime "),e._UZ(33,"p-sortIcon",8),e.qZA(),e.TgZ(34,"tr"),e._uU(35,"W9 Expire"),e.qZA(),e.TgZ(36,"tr"),e._uU(37,"Insurance Expire"),e.qZA(),e.TgZ(38,"tr"),e._uU(39,"Registration Expire"),e.qZA(),e.TgZ(40,"tr"),e._uU(41,"Licence Expire"),e.qZA(),e.TgZ(42,"tr"),e._uU(43,"Miles"),e.qZA(),e.TgZ(44,"tr"),e._uU(45,"Price"),e.qZA(),e.TgZ(46,"tr"),e._uU(47,"Average $"),e.qZA()()(),e.TgZ(48,"th",6)(49,"table")(50,"tr"),e._uU(51,"Dockhigh"),e.qZA(),e.TgZ(52,"tr"),e._uU(53,"LiftGate"),e.qZA(),e.TgZ(54,"tr"),e._uU(55,"Team"),e.qZA()()()())}function U(i,a){if(1&i&&(e.TgZ(0,"tr",17),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.locationDateTime)}}function x(i,a){if(1&i&&(e.TgZ(0,"tr",12),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.locationDateTime)}}const D=function(i,a){return{"border-style":i,"border-color":a}};function I(i,a){if(1&i&&(e.TgZ(0,"tr",9)(1,"td")(2,"table")(3,"tr",10),e._uU(4),e.qZA(),e.TgZ(5,"tr",10),e._uU(6),e.qZA(),e.TgZ(7,"tr",11),e._uU(8),e.qZA(),e.TgZ(9,"tr",11),e._uU(10),e.qZA(),e.TgZ(11,"tr",12),e._uU(12),e.qZA(),e.TgZ(13,"tr",12),e._uU(14),e.qZA()()(),e.TgZ(15,"td")(16,"table")(17,"tr",13),e._uU(18),e.qZA(),e.TgZ(19,"tr",14),e._uU(20),e.qZA(),e.TgZ(21,"tr",12),e._uU(22),e.qZA(),e.TgZ(23,"tr",12),e._uU(24),e.qZA(),e.TgZ(25,"tr",12),e._uU(26),e.qZA(),e.TgZ(27,"tr",12),e._uU(28),e.qZA()()(),e.TgZ(29,"td")(30,"table"),e.YNc(31,U,2,1,"ng-template",15),e.YNc(32,x,2,1,"ng-template",null,16,e.W1O),e.TgZ(34,"tr",10),e._uU(35),e.qZA(),e.TgZ(36,"tr",10),e._uU(37),e.qZA(),e.TgZ(38,"tr",11),e._uU(39),e.ALo(40,"number"),e.qZA()()(),e.TgZ(41,"td")(42,"table")(43,"tr",12),e._uU(44),e.qZA(),e.TgZ(45,"tr",12),e._uU(46),e.qZA(),e.TgZ(47,"tr",12),e._uU(48),e.qZA()()()()),2&i){const t=a.$implicit,r=e.MAs(33),l=e.oxw();e.Q6J("pSelectableRow",t)("ngStyle",e.WLB(25,D,l.isOutdatedExpire(t.w9date)||l.isOutdatedExpire(t.insuranceDate)||l.isOutdatedExpire(t.vechRegDate)||l.isOutdatedExpire(t.licenseDate)?"double":"single",l.isOutdatedExpire(t.w9date)||l.isOutdatedExpire(t.insuranceDate)||l.isOutdatedExpire(t.vechRegDate)||l.isOutdatedExpire(t.licenseDate)?"red":"green")),e.xp6(4),e.Oqu(t.statusUpdateDate),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Oqu(t.vechileId),e.xp6(2),e.Oqu(t.driverId),e.xp6(2),e.Oqu(t.contactNumber),e.xp6(2),e.Oqu(t.location),e.xp6(4),e.Oqu(t.dispatch),e.xp6(2),e.Oqu(t.category),e.xp6(2),e.Oqu(t.vechileType),e.xp6(2),e.Oqu(t.dimensions),e.xp6(2),e.Oqu(t.payload),e.xp6(2),e.Oqu(t.availableNote),e.xp6(3),e.Q6J("ngIf",l.isOutdated(t.locationDateTime))("ngIfElse",r),e.xp6(4),e.Oqu(t.miles),e.xp6(2),e.Oqu(t.price),e.xp6(2),e.hij(" ",e.xi3(40,22,t.price/t.miles,"1.2-2"),""),e.xp6(5),e.hij("",t.dockHigh," Dock"),e.xp6(2),e.hij("",t.liftGate," Lift"),e.xp6(2),e.hij("",t.team," Team")}}const b=function(){return["vechileType","distance","vechileId","driverId","contactNumber","location","dimensions","payload","availableNote","locationDateTime","status","dockHigh","liftGate","team","statusUpdateDate","statusUpdateUser"]},q=[{path:"",component:Z,children:[{path:"",component:(()=>{class i{constructor(t,r,l,n){this.vechileService=t,this.messageService=r,this.accountService=l,this.intervalConfigService=n,this.miles="",this.price="",this.pricePerMile="",this.vechileOriginId="",this.vechilesHistory=[],this.selectedRow=0,this.stateZip="",this.userName="",this.userRole="",this.ip="",this.intervalConfig=[],this.selectedCategory=[],this.categories=[],this.selectedVechType=[],this.vechTypes=[],this.selectedRatingType=[],this.ratingTypes=["0","1","2","3","4","5"],this.cols=[],this.sprinter=!1,this.small=!1,this.large=!1,this.form=new c.cw({rds:new c.NI("rds",c.kI.minLength(2)),dstzp:new c.NI("dstzp",c.kI.minLength(2)),vchlid:new c.NI("vchlid",c.kI.minLength(1)),sprinter:new c.NI("sprinter",c.kI.minLength(1)),small:new c.NI("small",c.kI.minLength(1)),large:new c.NI("large",c.kI.minLength(1))})}ngOnInit(){this.currentDatTime=new Date,this.intervalConfigService.getAll().pipe((0,g.P)()).subscribe(t=>this.intervalConfig=t),this.accountService.getById(this.accountService.userValue.id).pipe((0,g.P)()).subscribe(t=>{this.userRole=t.role,this.userName=t.firstName,this.ip=t.ip,this.vechileService.getHistory().pipe((0,g.P)()).subscribe(r=>{this.vechilesHistory=r;for(let o=0;o<this.vechilesHistory.length;o++)this.categories.findIndex(u=>u.label==this.vechilesHistory[o].category)<=-1&&this.categories.push({label:this.vechilesHistory[o].category,value:this.vechilesHistory[o].category}),this.vechTypes.findIndex(u=>u.label==this.vechilesHistory[o].vechileType)<=-1&&this.vechTypes.push({label:this.vechilesHistory[o].vechileType,value:this.vechilesHistory[o].vechileType})})}),this.form.get("rds").setValue(""),this.form.get("dstzp").setValue(""),this.form.get("vchlid").setValue("")}toIntg(t){return Number(t)}updateTimeDiffs(){this.timeDiffsByVechId=new Map,this.vechilesHistory.forEach(t=>{this.vechileService.getLockTimeDiff(t.vechileId).subscribe(r=>{this.timeDiffsByVechId.set(t.vechileId,r)})})}isOutdatedExpire(t){var r=h(new Date),l=h(t);return h.duration(r.diff(l)).asDays()>=parseInt(this.intervalConfig[0].expireDateInterval)}hideBillingDialog(){this.billingDialog=!1}getLockTimeDiff(t){return this.vechileService.getLockTimeDiff(t).subscribe(r=>this.ress=r),this.ress}openBillingDialog(t){this.vechileOriginId=t,this.vechileService.getById(t).pipe((0,g.P)()).subscribe(r=>{this.miles=r.miles,this.price=r.price}),this.billingDialog=!0}selectVechileHistory(t){this.messageService.add({severity:"info",summary:"VechileHistory Selected",detail:t.payload})}onRowSelect(t){this.messageService.add({severity:"info",summary:"VechileHistory Selected",detail:t.data.name})}toggleVisibility(t){}isOutdated(t){var r=h(new Date),l=h(t);return h.duration(r.diff(l)).asDays()>parseInt(this.intervalConfig[0].locDateInterval)}onVechileHistoryChange(t){this.table.filter(t.value,"vechileHistory","in")}onRepresentativeChange(t){this.table.filter(t.value,"representative","in")}onRowUnselect(t){this.messageService.add({severity:"info",summary:"VechileHistory Unselected",detail:t.data.name})}customSort(t){t.data.sort((r,l)=>{let n=r[t.field],o=l[t.field],u=null;return u=null==n&&null!=o?-1:null!=n&&null==o?1:null==n&&null==o?0:"string"==typeof n&&"string"==typeof o?n.localeCompare(o):n<o?-1:n>o?1:0,t.order*u})}deleteVechileHistory(t){if(!confirm("Are you sure you want to delete?"))return!1;this.vechilesHistory.find(n=>n.id===t),this.vechileService.delete(t).pipe((0,g.P)()).subscribe(()=>{this.vechilesHistory=this.vechilesHistory.filter(n=>n.id!==t)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.HT),e.Y36(v.ez),e.Y36(f.BR),e.Y36(f.cY))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],viewQuery:function(t,r){if(1&t&&e.Gf(T,5),2&t){let l;e.iGM(l=e.CRH())&&(r.table=l.first)}},features:[e._Bn([v.ez,d.uU])],decls:5,vars:5,consts:[[1,"card"],["selectionMode","single","dataKey","id",1,"table","table-striped","table-hover",3,"value","selection","filterDelay","globalFilterFields","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],[2,"width","25%"],[2,"width","30%"],["pSortableColumn","payload",2,"width","25%"],["field","payload"],[3,"pSelectableRow","ngStyle"],[2,"color","blue"],[2,"color","red"],[2,"color","green"],[2,"color","green","font-weight","bold"],[2,"color","red","font-weight","bold"],[3,"ngIf","ngIfElse"],["validDate",""],[2,"color","red","border-style","double","border-color","red"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"p-table",1,2),e.NdJ("selectionChange",function(n){return r.selectedVechileHistory=n}),e.YNc(3,A,56,0,"ng-template",3),e.YNc(4,I,49,28,"ng-template",4),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("value",r.vechilesHistory)("selection",r.selectedVechileHistory)("filterDelay",0)("globalFilterFields",e.DdM(4,b)))},dependencies:[d.O5,d.PC,p.iA,v.jx,p.lQ,p.Ei,p.fz,d.JJ],encapsulation:2}),i})()},{path:"info/:driverId",component:s(4681).y}]}];let O=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Bz.forChild(q),m.Bz]}),i})();var L=s(9483),S=s(9549),V=s(4144),N=s(3238),E=s(6308),R=s(5415),M=s(666),B=s(2453),F=s(585),J=s(8177),w=s(5722),z=s(4076),P=s(1493),Y=s(5593),j=s(8235),Q=s(1740),G=s(1383);let X=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[d.ez,c.UX,O,L.FA,S.lN,V.c,N.XK,E.JX,R.T,p.U$,M.kW,B.EV,F._8,J.JH,w.q4,z.vI,P.S,Y.hJ,j.q,Q.j,c.u5,G.V]}),i})()}}]);