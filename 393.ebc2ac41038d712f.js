"use strict";(self.webpackChunkDistanceCalcFront=self.webpackChunkDistanceCalcFront||[]).push([[393],{393:(G,v,i)=>{i.r(v),i.d(v,{RatingsModule:()=>H});var r=i(4719),g=i(6895),d=i(5146),t=i(5062);let T=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-1"],[1,"container"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"router-outlet"),t.qZA()())},dependencies:[d.lC],encapsulation:2}),n})();var Z=i(9671),l=i(7224),p=i(805),u=i(9429),h=i(793),f=i(666),C=i(1383);function L(n,o){1&n&&(t.TgZ(0,"div",5),t._UZ(1,"i",6),t.TgZ(2,"div"),t._uU(3,"Updating ratings..."),t.qZA()())}function x(n,o){1&n&&(t.TgZ(0,"th"),t._uU(1,"Vehicle Id"),t.qZA(),t.TgZ(2,"th"),t._uU(3,"Rating"),t.qZA())}function M(n,o){1&n&&t._UZ(0,"span",16)}function R(n,o){1&n&&t._UZ(0,"span",17)}const A=function(){return[]};function y(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"tr",12)(1,"td")(2,"input",13),t.NdJ("ngModelChange",function(a){const m=t.CHM(e).$implicit;return t.KtG(m.isChecked=a)}),t.qZA(),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t.YNc(7,M,1,0,"span",14),t.YNc(8,R,1,0,"span",15),t.qZA()()}if(2&n){const e=o.$implicit,s=t.oxw(2);t.Q6J("pSelectableRow",e),t.xp6(2),t.s9C("name",e.vechileId),t.s9C("id",e.vechileId),t.Q6J("ngModel",e.isChecked),t.xp6(1),t.hij(" ",e.vechileId,""),t.xp6(2),t.hij(" ",e.rating," "),t.xp6(2),t.Q6J("ngForOf",t.DdM(8,A).constructor(s.toIntg(e.rating))),t.xp6(1),t.Q6J("ngForOf",t.DdM(9,A).constructor(s.toIntg(5-e.rating)))}}function I(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",7)(1,"p-table",8,9),t.NdJ("selectionChange",function(a){t.CHM(e);const c=t.oxw();return t.KtG(c.selectedVechile=a)}),t.YNc(3,x,4,0,"ng-template",10),t.YNc(4,y,9,10,"ng-template",11),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("value",e.vechiles)("selection",e.selectedVechile)}}const U=[{path:"",component:T,children:[{path:"",component:(()=>{class n{constructor(e,s,a,c,m,K){this.vechileService=e,this.messageService=s,this.accountService=a,this.intervalConfigService=c,this.router=m,this.route=K,this.ratings=[],this.selectedRating=[],this.userName="",this.userRole="",this.vechIds=[],this.loading=!1}setLoading(e){this.loading=e}getLoading(){return this.loading}get values(){return this.vechIds=this.vechiles.filter(e=>e.isChecked).map(e=>e.vechileId),this.vechIds}ngOnInit(){this.setLoading(!0),this.ratings=["0","1","2","3","4","5"],this.intervalConfigService.getAll().pipe((0,l.P)()).subscribe(e=>this.intervalConfig=e),this.accountService.getById(this.accountService.userValue.id).pipe((0,l.P)()).subscribe(e=>{this.userRole=e.role,this.userName=e.firstName,this.vechileService.getAll().pipe((0,l.P)()).subscribe(s=>{this.vechiles=s})}),this.setLoading(!1)}toIntg(e){return Number(e)}onChange(e,s){this.vechileService.update(e,s).pipe((0,l.P)()).subscribe()}assignRatings(){var e=this;return(0,Z.Z)(function*(){e.setLoading(!0);for(let s=0;s<e.vechIds.length;s++)yield e.vechileService.getByVechileId(e.vechIds[s]).pipe((0,l.P)()).subscribe(a=>{a.rating=e.selectedRating,e.vechileService.update(a.id,a).pipe((0,l.P)()).subscribe()});yield new Promise(s=>setTimeout(s,4e3)),yield e.vechileService.getAll().pipe((0,l.P)()).subscribe(s=>e.vechiles=s),e.setLoading(!1)})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.HT),t.Y36(p.ez),t.Y36(u.BR),t.Y36(u.cY),t.Y36(d.F0),t.Y36(d.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t._Bn([p.ez,g.uU])],decls:14,vars:7,consts:[[1,"p-toolbar-group-left"],[3,"options","ngModel","ngModelChange"],[1,"text-danger",3,"click"],["class","text-center",4,"ngIf"],["class","card",4,"ngIf"],[1,"text-center"],[1,"fa","fa-spinner","fa-spin","fa-3x","fa-fw"],[1,"card"],["selectionMode","single","dataKey","id",1,"table","table-striped","table-hover",3,"value","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],[3,"pSelectableRow"],["type","checkbox",3,"ngModel","name","id","ngModelChange"],["class","fa fa-star checked",4,"ngFor","ngForOf"],["class","fa fa-star unchecked",4,"ngFor","ngForOf"],[1,"fa","fa-star","checked"],[1,"fa","fa-star","unchecked"]],template:function(e,s){1&e&&(t.TgZ(0,"p-toolbar")(1,"div",0),t._uU(2,"\xa0 \xa0 \xa0 \xa0 "),t.TgZ(3,"label"),t._uU(4,"Assign rating to groups"),t.qZA(),t._uU(5,"\xa0 \xa0 \xa0 \xa0 "),t.TgZ(6,"p-dropdown",1),t.NdJ("ngModelChange",function(c){return s.selectedRating=c}),t.qZA(),t._uU(7," \xa0 \xa0 \xa0 \xa0 "),t.TgZ(8,"a",2),t.NdJ("click",function(){return s.assignRatings()}),t._uU(9,"Update"),t.qZA(),t._uU(10),t.ALo(11,"json"),t.qZA()(),t.YNc(12,L,4,0,"div",3),t.YNc(13,I,5,2,"div",4)),2&e&&(t.xp6(6),t.Q6J("options",s.ratings)("ngModel",s.selectedRating),t.xp6(4),t.hij(" \xa0 \xa0 \xa0 \xa0 ",t.lcZ(11,5,s.values)," "),t.xp6(2),t.Q6J("ngIf",s.loading),t.xp6(1),t.Q6J("ngIf",!s.loading))},dependencies:[g.sg,g.O5,r.Wl,r.JJ,h.iA,p.jx,h.Ei,f.Lt,r.On,C.o,g.Ts],encapsulation:2}),n})()}]}];let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.Bz.forChild(U),d.Bz]}),n})();var S=i(9483),F=i(9549),N=i(4144),Y=i(3238),j=i(6308),B=i(5415),P=i(2453),Q=i(585),b=i(8177),O=i(5722),V=i(4076),z=i(1493),X=i(5593),D=i(8235),E=i(1740);let H=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,r.UX,J,S.FA,F.lN,N.c,Y.XK,j.JX,B.T,h.U$,f.kW,P.EV,Q._8,b.JH,O.q4,V.vI,z.S,X.hJ,D.q,E.j,r.u5,C.V]}),n})()}}]);